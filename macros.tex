% Formatting tricks so we can fit two inference rules side by side
\renewcommand{\predicatebegin}{\hspace{-.5em}$}
\renewcommand{\predicateend}{\hspace{-.5em}$}

% \mathlig{-x}{\mathbin{\multimap}}
\mathlig{-x}{\mathbin{-\mspace{-8mu}\times}}
\newcommand\opfail[1]{\overset{{#1}}{-x}}
\mathlig{++}{\mathbin{{+}\mspace{-10mu}{+}}}
\mathlig{->>}{\twoheadrightarrow}
\mathlig{<-}{\leftarrow}

\reservestyle{\functions}{\texttt}
\functions{isValidElement,isValidTransaction,getElementFromTransaction,
getElementsFromBatch,Hash,isValidBatch, AddElement,isReady,reverse, Reverse,
shouldConsolidateHash,reset,newEpoch,Sign,isValidSignature, RecoverPK}
\reservestyle{\setchainOp}{\texttt}
\setchainOp{add,get,theset[the\_set],epoch,history,epocinc[epoch\_inc]}
\reservestyle{\tendermint}{\texttt}
\tendermint{broadcastTx[Tendermint.Broadcast],abciquery[Tendermint.Query]}
\reservestyle{\abci}{\texttt}
\abci{CheckTx,DeliverTx,EndBlock,BeginBlock,Query,Commit}
\reservestyle{\variablesProg}{\texttt}
\variablesProg{epoch,history,element,transaction,batch}

\reservestyle{\txexec}{\texttt}
\txexec{nogas[no-gas],txsuc[tx-suc],txfail[tx-fail]}

% Operations
\reservestyle{\operations}{\mathsf}
\operations{dest,param,money,src}

% New opcode
\newcommand{\textbfup}[1]{\textup{\texttt{#1}}}
\reservestyle{\mech}{\textbfup}
%\mech{first,count,fail,setFail,isSelfOnly,txmem[transaction memory]}
\mech{first,count,fail,setFail,isSelfOnly,txmem[trmem],bstore,ustore,queue}

%Sets/Types
\reservestyle{\types}{\textit}
\types{Addr,SmartContract}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

%\reservestyle{\monitors}{\mathsf}
\reservestyle{\monitors}{\mathit}
\monitors{init,term,begin,end,hookup,fst}

\reservestyle{\infrule}{\textsc}
\infrule{einit,emon,eterm,efail,failinit,failterm,failop,failtx,
   opok[op-ok],opfail[op-fail],bfail[op-begin],efail[op-end]}


%ABCI
\newcommand{\BeginBlock}{\<BeginBlock>\xspace}
\newcommand{\EndBlock}{\<EndBlock>\xspace}
\newcommand{\CheckTx}{\<CheckTx>\xspace}
\newcommand{\Commit}{\<Commit>\xspace}
\newcommand{\DeliverTx}{\<DeliverTx>\xspace}
\newcommand{\Query}{\<Query>\xspace}


%%%
\makeatletter
\let\orgdescriptionlabel\descriptionlabel
\renewcommand*{\descriptionlabel}[1]{%
  \let\orglabel\label
  \let\label\@gobble
  \phantomsection
  \edef\@currentlabel{#1}%
  %\edef\@currentlabelname{#1}%
  \let\label\orglabel
  \orgdescriptionlabel{#1}%
}
\makeatother

\newcommand{\PR}[1]{\ensuremath{\textit{#1}}}
\newcommand{\GS}{\PR{GS}\xspace}
\newcommand{\EPOCH}{\<epoch>}
\newcommand{\CURRENT}{\<current>}
\newcommand{\HISTORY}{\<history>}
\newcommand{\THESET}{\<theset>}
\newcommand{\epochs}{Setchain\xspace}
%\newcommand{\Get}{\PR{get}\xspace}
%\newcommand{\Add}{\PR{add}\xspace}
\newcommand{\BRBdeliver}{\<BRB>.\<Deliver>}
\newcommand{\BRBbroadcast}{\<BRB>.\<Broadcast>}
\newcommand{\BABdeliver}{\<BAB>.\<Deliver>}
\newcommand{\BABbroadcast}{\<BAB>.\<Broadcast>}
\newcommand{\setchain}{Setchain\xspace}
\newcommand{\vanilla}{Vanilla\xspace}
\newcommand{\hashchain}{Hashchain\xspace}
\newcommand{\compresschain}{Compresschain\xspace}
\newcommand{\collector}{\emph{collector}\xspace}
\newcommand{\hcollector}{\emph{hash collector}\xspace}
\newcommand{\setchains}{Setchains\xspace}
\newcommand{\SPH}{\texttt{SIGNATURES\_PER\_HASH}\xspace}

\newcommand{\Hspeed}{H1}
\newcommand{\Hbetteralg}{H2}
\newcommand{\Hagr}{H3}
\newcommand{\Hbyzantine}{H4}
\newcommand{\Hdegrade}{H5}

\newcommand{\Dom}{\PR{Dom}}
\newcommand{\Propset}{\PR{propset}}
\newcommand{\Servers}{N}

\newcommand{\byzantineset}{\mathbb{B}}
\newcommand{\correctset}{\mathbb{C}}
\newcommand{\Proposal}{\PR{proposal}}


\newcommand{\AlgTwo}{Alg.~\ref{DPO-alg-basb}\xspace}
\newcommand{\AlgThree}{Alg.~\ref{DPO-alg-basb3}\xspace}
% \newcommand{\AlgTwoSet}{Alg.~\ref{DPO-alg-basb}+set\xspace}
\newcommand{\AlgTwoSet}{Alg.~\ref{DPO-alg-basb}+set\xspace}
%\newcommand{\AlgThreeSet}{Alg.~\ref{DPO-alg-basb3}+set\xspace}
\newcommand{\AlgThreeSet}{Alg.~\ref{DPO-alg3-aggregated}\xspace}

\newcommand{\TXONE}[1]{\ensuremath{\textit{#1}}\xspace}
\newcommand{\TXTWO}[2]{\ensuremath{\textit{#1}\_\textit{#2}}\xspace}
\newcommand{\TXTHREE}[3]{\ensuremath{\textit{#1}\_\textit{#2}\_\textit{#3}}\xspace}
\newcommand{\HaveSubset}{\TXTWO{have}{subset}}
\newcommand{\GenerateInvalidElems}{\TXTHREE{generate}{invalid}{elems}}
\newcommand{\HavocNumber}{\TXTWO{havoc}{number}}
\newcommand{\HavocSubset}{\TXTWO{havoc}{subset}}
\newcommand{\HavocPartition}{\TXTWO{havoc}{partition}}
\newcommand{\HavocElement}{\TXTWO{havoc}{element}}
\newcommand{\Knowledge}{\TXONE{knowledge}}
\newcommand{\ByzantineKnowledge}{\TXTWO{byzantine}{knowledge}}
\newcommand{\ValidElements}{\TXTWO{valid}{elements}}
\newcommand{\EV}{\TXONE{ev}}

\newcommand{\SendBrb}{\TXONE{SendBRB}}
\newcommand{\Tau}{\mathcal{T}}
