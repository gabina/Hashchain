% Hash Collector - alg3
\begin{figure}[t!]
  \begin{adjustbox}{minipage=[t]{\columnwidth}}
    \begin{algorithm}[H]
      \renewcommand{\thealgorithm}{Hash Collector}         
      \caption{}%
      \label{alg:collector-hash}%
      \small
      \begin{algorithmic}[1]
            \State \textbf{Init:} \texttt{batch} $\leftarrow$ \{\}
      
            \Function{\<AddElement>}{$element$}\label{alg:hash_add_tx}
            		\If {\<isValidElement>($element$)}
            			\State \texttt{encoded\_element} $\leftarrow$ \texttt{RLP.Encode}($element$)
					        \State \texttt{batch} $\leftarrow$ \texttt{batch} $\cup$ \{\texttt{encoded\_element}\}
                \EndIf
             		
                \If {\<isReady>(\<batch>)}
             		  \State \texttt{hash} $\leftarrow$  \texttt{Hash}(\texttt{batch})
                	\State \texttt{Tendermint.Broadcast}(\texttt{hash})
              		\State \Call{\<reset>}{\null}
             	  \EndIf
                \State \textbf{return}
            \EndFunction

            \Function{\<Reverse>}{$h$, $s$}\label{alg:hash_request_tx}
              \State \texttt{public\_key} = \<RecoverPK>($s$)
              \If {\texttt{public\_key} = \texttt{MY\_PUBLIC\_KEY}}
                \State \texttt{batch} = \texttt{DATA\_BASE[$h$]} 
              \EndIf
              \State \textbf{return}
            \EndFunction
            
            \Function{\<reset>}{\null}\label{alg:hash_reset}
            		\State \texttt{batch} $\leftarrow$ \{\}
                \State \textbf{return}
            \EndFunction
        \end{algorithmic}
      \end{algorithm}
	\end{adjustbox}
  \end{figure}
